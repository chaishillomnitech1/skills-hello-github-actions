# AI-Powered PR Assistant Workflow

## Overview

The AI-Powered PR Assistant is a GitHub Actions workflow that leverages OpenAI's GPT-4 to automatically analyze pull requests and provide intelligent assistance. This workflow helps streamline the PR review process by generating summaries, suggesting labels, and creating changelog entries.

## Features

### 1. **Automatic PR Summary Generation**
- Analyzes PR title, description, and changed files
- Generates a concise 2-3 sentence summary using AI
- Posts the summary as a comment on the PR

### 2. **Intelligent Label Suggestions**
- Suggests relevant labels based on the PR content
- Automatically applies labels that exist in the repository
- Skips labels that don't exist to avoid errors

### 3. **Changelog Entry Generation**
- Creates a well-formatted changelog entry
- Can be manually added to your changelog file
- Follows markdown formatting conventions

## Setup Instructions

### Prerequisites

1. **OpenAI API Key**: You need an OpenAI API key with access to GPT-4 or GPT-3.5-turbo

### Configuration Steps

1. **Add OpenAI API Key to Repository Secrets**:
   - Go to your repository on GitHub
   - Navigate to **Settings** ‚Üí **Secrets and variables** ‚Üí **Actions**
   - Click **New repository secret**
   - Name: `OPENAI_API_KEY`
   - Value: Your OpenAI API key (starts with `sk-`)
   - Click **Add secret**

2. **Verify Workflow Permissions**:
   - The workflow requires the following permissions (already configured):
     - `pull-requests: write` - To comment on PRs and add labels
     - `contents: read` - To read repository content
     - `issues: write` - To manage labels

3. **Activate the Workflow**:
   - The workflow is automatically triggered when:
     - A new pull request is opened
     - An existing PR is updated (synchronized)
     - A closed PR is reopened

## How It Works

### Workflow Trigger Events

```yaml
on:
  pull_request:
    types: [opened, synchronize, reopened]
```

The workflow runs automatically on these PR events.

### Processing Steps

1. **Checkout Code**: Fetches the repository code with full history
2. **Get PR Details**: Extracts PR metadata (title, description, changed files)
3. **Generate AI Summary**: Calls OpenAI API to analyze the PR and generate insights
4. **Post Comment**: Adds a formatted comment with AI-generated content
5. **Apply Labels**: Automatically applies suggested labels if they exist
6. **Update Changelog**: Prepares a changelog entry (manual integration required)

### AI Analysis Process

The workflow sends the following information to OpenAI:
- PR title and description
- List of changed files with additions/deletions
- Number of files changed

The AI responds with:
- A concise summary of the changes
- Suggested labels appropriate for the PR
- A changelog entry in markdown format

## Example Output

When a PR is opened or updated, the workflow posts a comment like this:

```markdown
## ü§ñ AI-Powered PR Assistant

### üìã Summary
This PR introduces a new authentication feature that adds JWT token validation 
to the API endpoints. The changes include middleware implementation and 
comprehensive test coverage.

### üè∑Ô∏è Suggested Labels
`enhancement`, `security`, `api`

### üìù Changelog Entry
- Add JWT token validation middleware for API authentication
- Implement token refresh mechanism
- Add comprehensive tests for auth flows

---
_This comment was automatically generated by the AI PR Assistant workflow._
```

## Customization Options

### Modify AI Behavior

Edit the prompt in the `Generate AI PR Summary` step to customize the AI's analysis:

```javascript
const prompt = `You are a helpful PR assistant. Analyze this pull request and provide:
1. A concise summary (2-3 sentences)
2. Suggested labels (comma-separated list)
3. A changelog entry in markdown format
...`;
```

### Change AI Model

Update the model parameter in the OpenAI API call:

```javascript
model: 'gpt-4',  // Options: 'gpt-4', 'gpt-3.5-turbo'
```

### Adjust Response Length

Modify the `max_tokens` parameter:

```javascript
max_tokens: 500,  // Increase for longer responses
```

### Enable Automatic Changelog Updates

Uncomment the changelog update logic in the `Update Changelog` step to automatically commit changelog entries.

## Troubleshooting

### Issue: Workflow doesn't run

**Solution**: 
- Check that the workflow file is in `.github/workflows/` directory
- Verify the file has `.yml` or `.yaml` extension
- Check GitHub Actions tab for any errors

### Issue: AI summary not generated

**Possible causes**:
1. OpenAI API key not configured
   - Add `OPENAI_API_KEY` to repository secrets
2. Invalid API key
   - Verify the key is correct and has sufficient credits
3. API rate limits exceeded
   - Check your OpenAI account usage

**Fallback behavior**: If AI generation fails, the workflow posts a basic summary with file statistics.

### Issue: Labels not applied

**Possible causes**:
- Suggested labels don't exist in the repository
- Insufficient permissions

**Solution**: The workflow only applies labels that already exist in the repository. Create the suggested labels manually if needed.

## Security Considerations

1. **API Key Protection**: 
   - Never commit your OpenAI API key to the repository
   - Always use GitHub Secrets for sensitive data
   - Rotate keys periodically

2. **Token Permissions**:
   - The workflow uses `GITHUB_TOKEN` with minimal required permissions
   - Review permissions in the workflow file if modifying

3. **Rate Limiting**:
   - OpenAI API has rate limits based on your account tier
   - The workflow includes error handling for API failures

## Cost Considerations

- Each PR analysis makes one API call to OpenAI
- Cost depends on your OpenAI pricing tier and token usage
- Typical cost: $0.01-0.03 per PR (using GPT-4)
- Consider using GPT-3.5-turbo for lower costs

## Best Practices

1. **Review AI Suggestions**: Always review AI-generated content before taking action
2. **Customize Prompts**: Tailor the AI prompts to your team's needs
3. **Monitor Usage**: Keep track of OpenAI API usage and costs
4. **Iterate**: Improve the workflow based on team feedback
5. **Test First**: Test the workflow on a few PRs before full rollout

## Advanced Features (Future Enhancements)

Potential improvements you could add:
- Code quality scoring
- Security vulnerability detection
- Breaking change identification
- Test coverage analysis
- Documentation completeness check
- Similar PR detection

## Support and Feedback

For issues or suggestions:
1. Check the workflow logs in GitHub Actions tab
2. Review this documentation
3. Open an issue in the repository
4. Consult OpenAI API documentation for API-related issues

## License

This workflow is part of the repository and follows the same license (MIT).

---

**Note**: This workflow uses OpenAI's API which is a third-party service. Ensure compliance with your organization's policies regarding AI tool usage and data privacy.
